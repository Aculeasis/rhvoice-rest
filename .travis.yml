language:
  python

python:
  '3.6'

services:
  - docker

sudo:
  required

git:
  depth: 1

addons:
  apt:
    packages:
      - docker-ce

before_install:
  - docker --version
  - docker build -t aculeasis/rhvoice-rest-test:amd64 -f Dockerfile.amd64 .
  - docker run -d -p 8080:8080 -e THREADED=6 --name rhvoice-rest aculeasis/rhvoice-rest-test:amd64
  - sleep 5
  - docker ps images
  - docker ps -a

install:
  - pip install aiohttp

script:
  - python -u example/threaded_test.py

after_script:
  - docker logs rhvoice-rest
  - docker stop rhvoice-rest
  - docker ps -a
